{
  "extract_id": "extract_a4b25e685db041bfaf7466c55b1889c6",
  "results": [
    {
      "url": "https://docs.snowflake.com/en/sql-reference/account-usage/query_attribution_history",
      "title": "QUERY_ATTRIBUTION_HISTORY view | Snowflake Documentation",
      "publish_date": "2026-01-01",
      "excerpts": [
        "[DOCUMENTATION](https://docs.snowflake.com)\n\n/\n\nGet started\n\nGuides\n\nDeveloper\n\nReference\n\nRelease notes\n\nTutorials\n\n[Status](https://status.snowflake.com)\n\nReference General reference SNOWFLAKE database Account Usage QUERY\\_ATTRIBUTION\\_HISTORY\n\nSchemas:\n    ACCOUNT\\_USAGE\n\n# QUERY\\_ ATTRIBUTION\\_ HISTORY view \u00b6\n\nThis Account Usage view can be used to determine the compute cost of a given query run on warehouses in your account\nin the last 365 days (1 year).\n\nFor more information, see Viewing cost by tag in SQL .\n\n## Columns \u00b6\n\n|Column name |Data type |Description |\n| --- | --- | --- |\n|QUERY\\_ID |VARCHAR |Internal/system-generated identifier for the SQL statement. |\n|PARENT\\_QUERY\\_ID |VARCHAR |Query ID of the parent query or NULL if the query does not have a parent. |\n|ROOT\\_QUERY\\_ID |VARCHAR |Query ID of the topmost query in the chain or NULL if the query does not have a parent. |\n|WAREHOUSE\\_ID |NUMBER |Internal/system-generated identifier for the warehouse that the query was executed on. |\n|WAREHOUSE\\_NAME |VARCHAR |Name of the warehouse that the query executed on. |\n|QUERY\\_HASH |VARCHAR |The hash value computed based on the canonicalized SQL text. |\n|QUERY\\_PARAMETERIZED\\_HASH |VARCHAR |The hash value computed based on the parameterized query. |\n|QUERY\\_TAG |VARCHAR |Query tag set for this statement through the QUERY\\_TAG session parameter. |\n|USER\\_NAME |VARCHAR |User who issued the query. |\n|START\\_TIME |TIMESTAMP\\_LTZ |Time when query execution started (in the local time zone). |\n|END\\_TIME |TIMESTAMP\\_LTZ |Time when query execution ended (in the local time zone). |\n|CREDITS\\_ATTRIBUTED\\_COMPUTE |NUMBER |Number of credits attributed to this query. Includes only the credit usage for the query execution and doesn\u2019t include any warehouse idle time. |\n|CREDITS\\_USED\\_QUERY\\_ACCELERATION |NUMBER |Number of credits consumed by the Query Acceleration Service to accelerate the query. NULL if the query is not accelerated. . . The total cost for an accelerated query is the sum of this column and the CREDITS\\_ATTRIBUTED\\_COMPUTE column. |\n\n## Usage notes \u00b6\n\n* Latency for this view can be up to eight hours.\n* This view displays results for any role granted the USAGE\\_VIEWER or GOVERNANCE\\_VIEWER database role .\n\n* The value in the `credits_attributed_compute` column contains the warehouse credit usage for executing the query,\n  inclusive of any resizing and/or autoscaling of multi-cluster warehouse(s). This cost is attributed based on\n  the weighted average of the resource consumption.\n  \n  The value doesn\u2019t include any credit usage for warehouse idle time. Idle time is a period\n  of time in which no queries are running in the warehouse and can be measured at the warehouse level.\n  \n  The value doesn\u2019t include any other credit usage that is incurred as a result of query execution.\n  For example, the following are not included in the query cost:\n  \n    + Data transfer costs\n    + Storage costs\n    + Cloud services costs\n    + Costs for serverless features\n    + Costs for tokens processed by AI services\n* For queries that are executed concurrently, the cost of the warehouse is attributed to individual queries based on the\n  weighted average of their resource consumption during a given time interval.\n* Short-running queries (<= ~100ms) are currently too short for per query cost attribution and are not included in the view.\n* Data for all columns is available starting from mid-August, 2024. Some data prior to this date might be available in the view, but\n  might be incomplete.\n\n## Examples \u00b6\n\n### Query costs for related queries \u00b6\n\nTo determine the costs of a specific query and similar queries using the query parameterized hash, replace `<query_id>` and execute the following statements:\n\n```\nSET query_id = '<query_id>' ; \n\n WITH query_hash_of_query AS ( \n  SELECT query_parameterized_hash \n  FROM SNOWFLAKE . ACCOUNT_USAGE . QUERY_ATTRIBUTION_HISTORY \n  WHERE query_id = $ query_id \n  LIMIT 1 \n ) \n SELECT \n  query_parameterized_hash , \n  COUNT (*) AS query_count , \n  SUM ( credits_attributed_compute ) AS recurrent_query_attributed_credits \n FROM SNOWFLAKE . ACCOUNT_USAGE . QUERY_ATTRIBUTION_HISTORY \n WHERE start_time >= DATE_TRUNC ( 'MONTH' , CURRENT_DATE ) \n  AND start_time < CURRENT_DATE \n  AND query_parameterized_hash = ( SELECT query_parameterized_hash FROM query_hash_of_query ) \n GROUP BY ALL ;\n```\n\nCopy\n\n### Query costs for the current user \u00b6\n\nTo determine the costs of queries executed by the current user for the current month, execute the following statement:\n\n```\nSELECT user_name , SUM ( credits_attributed_compute ) AS credits \n  FROM SNOWFLAKE . ACCOUNT_USAGE . QUERY_ATTRIBUTION_HISTORY \n  WHERE user_name = CURRENT_USER () \n    AND start_time >= DATE_TRUNC ( 'MONTH' , CURRENT_DATE ) \n    AND start_time < CURRENT_DATE \n  GROUP BY user_name ;\n```\n\nCopy\n\nFor an example of attributing warehouse costs to users, see Resources shared by users from different departments .\n\n### Query costs for stored procedures \u00b6\n\nFor stored procedures that issue multiple hierarchical queries, you can compute the attributed query costs for the\nprocedure by using the root query ID for the procedure.\n\n1. To find the root query ID for a stored procedure, use the ACCESS\\_HISTORY view . For example,\n   to find the root query ID for a stored procedure, set the `query_id` and execute the following statements:\n   \n   ```\n   SET query_id = '<query_id>' ; \n   \n    SELECT query_id , \n          parent_query_id , \n          root_query_id , \n          direct_objects_accessed \n     FROM SNOWFLAKE . ACCOUNT_USAGE . ACCESS_HISTORY \n     WHERE query_id = $ query_id ;\n   ```\n   \n   Copy\n   \n   For more information, see Ancestor queries with stored procedures .\n2. To sum the query cost for the entire procedure, replace `<root_query_id>` and execute the following statements:\n   \n   ```\n   SET query_id = '<root_query_id>' ; \n   \n    SELECT SUM ( credits_attributed_compute ) AS total_attributed_credits \n     FROM SNOWFLAKE . ACCOUNT_USAGE . QUERY_ATTRIBUTION_HISTORY \n     WHERE ( root_query_id = $ query_id OR query_id = $ query_id );\n   ```\n   \n   Copy\n\n### Additional examples \u00b6\n\nFor more examples, see Resources shared by users from different departments .\n\nWas this page helpful?\n\nYes No\n\n[Visit Snowflake](https://www.snowflake.com)\n\n[Join the conversation](https://community.snowflake.com/s/)\n\n[Develop with Snowflake](https://developers.snowflake.com)\n\nShare your feedback\n\n[Read the latest on our blog](https://www.snowflake.com/blog/)\n\n[Get your own certification](https://learn.snowflake.com)\n\nOn this page\n\n1. Columns\n2. Usage notes\n3. Examples\n4. Query costs for related queries\n5. Query costs for the current user\n6. Query costs for stored procedures\n7. Additional examples\n\nRelated content\n\n1. Overview of warehouses\n\nLanguage: **English**\n\n* English\n* Fran\u00e7ais\n* Deutsch\n* \u65e5\u672c\u8a9e\n* \ud55c\uad6d\uc5b4\n* Portugu\u00eas\n\n## Snowflake's Use of Cookies\n\n## Privacy Preference Center\n\nYour Opt Out Preference Signal is Honored\n\n* ### Your Privacy\n* ### Strictly Necessary Cookies\n* ### Performance Cookies\n* ### Functional Cookies\n* ### Targeting Cookies\n\n#### Your Privacy\n\nWhen you visit any website, it may store or retrieve information on your browser, mostly in the form of cookies. This information might be about you, your preferences or your device and is mostly used to make the site work as you expect it to. The information does not usually directly identify you, but it can give you a more personalized web experience. Because we respect your right to privacy, you can choose not to allow some types of cookies. Click on the different category headings to find out more and change our default settings. However, blocking some types of cookies may impact your experience of the site and the services we are able to offer.  \n[More information](https://cookiepedia.co.uk/giving-consent-to-cookies)\n\n#### Strictly Necessary Cookies\n\nAlways Active\n\nThese cookies are necessary for the website to function and cannot be switched off. They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms. You can set your browser to block or alert you about these cookies, but some parts of the site will not then work. These cookies do not store any personally identifiable information.\n\nCookies Details\u200e\n\n#### Performance Cookies\n\nPerformance Cookies\n\nThese cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site. They help us to know which pages are the most and least popular and see how visitors move around the site.    All information these cookies collect is aggregated and therefore anonymous. If you do not allow these cookies we will not know when you have visited our site, and will not be able to monitor its performance.\n\nCookies Details\u200e\n\n#### Functional Cookies\n\nFunctional Cookies\n\nThese cookies enable the website to provide enhanced functionality and personalisation. They may be set by us or by third party providers whose services we have added to our pages.    If you do not allow these cookies then some or all of these services may not function properly.\n\nCookies Details\u200e\n\n#### Targeting Cookies\n\nTargeting Cookies\n\nThese cookies may be set through our site by our advertising partners. They may be used by those companies to build a profile of your interests and show you relevant adverts on other sites. They do not store directly identifiable personal information, but are based on uniquely identifying your browser and internet device. If you do not allow these cookies, you will experience less targeted advertising.\n\nCookies Details\u200e\n\n### Cookie List\n\nConsent Leg.Interest\n\ncheckbox label label\n\ncheckbox label label\n\ncheckbox label label\n\nClear\n\ncheckbox label label\n\nApply Cancel\n\nConfirm My Choices\n\nAllow All\n\n[](https://www.onetrust.com/products/cookie-consent/)"
      ],
      "full_content": null
    }
  ],
  "errors": [],
  "warnings": [
    {
      "type": "warning",
      "message": "Neither objective nor search_queries were provided, provide at least one to increase the relevance of excerpts.",
      "detail": null
    }
  ],
  "usage": [
    {
      "name": "sku_extract_excerpts",
      "count": 1
    }
  ]
}
