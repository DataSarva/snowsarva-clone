{"search_id":"search_293dd0e4c98141b38807b2acc7d9cf5c","results":[{"url":"https://docs.snowflake.com/en/user-guide/cost-attributing","title":"Attributing cost | Snowflake Documentation","excerpts":["Accounts\")\n[Business continuity & data recovery](/en/user-guide/replication-intro \"Business continuity & data recovery\")\n[Performance optimization](/en/guides-overview-performance \"Performance optimization\")\n[Cost & Billing](/en/guides-overview-cost \"Cost & Billing\")\n[Guides](/en/guides) [Cost & Billing](/en/guides-overview-cost) Visibility Attributing cost\n ... \nSection Title: ... > Viewing cost by tag in SQL [¶]( \"Link to this heading\")\nContent:\n**Attributing costs within an account**You can attribute costs within an account by querying the following views in the [ACCOUNT_USAGE](../sql-reference/account-usage) schema:\n[TAG_REFERENCES view](../sql-reference/account-usage/tag_references) : Identifies objects (for example, warehouses and users) that have tags. [WAREHOUSE_METERING_HISTORY view](../sql-reference/account-usage/warehouse_metering_history) : Provides credit usage for warehouses. [QUERY_ATTRIBUTION_HISTORY view](../sql-reference/account-usage/query_attribution_history) : Provides the compute costs for queries. The cost per query is\nthe warehouse credit usage for executing the query.For more information on using this view, see [About the QUERY_ATTRIBUTION_HISTORY view]() .\nSection Title: ... > Viewing cost by tag in SQL [¶]( \"Link to this heading\")\nContent:\n**Attributing costs across accounts in an organization**Within an organization, you can also attribute costs for resources that are used **exclusively by a single department** by\nquerying views in the [ORGANIZATION_USAGE](../sql-reference/organization-usage) schema from the [organization account](organization-accounts) .Note\nIn the ORGANIZATION_USAGE schema, the TAG_REFERENCES view is only available in the organization account. The QUERY_ATTRIBUTION_HISTORY view is only available in the ACCOUNT_USAGE schema for an account. There is no\norganization-wide equivalent of the view.\n ... \nSection Title: ... > Resources not shared by departments [¶]( \"Link to this heading\")\nContent:\nSuppose that you want to attribute costs by department and that each department uses a set of dedicated warehouses.\nIf you tag warehouses with a `cost_center` tag to identify the department that owns the warehouse, you can join the\nACCOUNT_USAGE [TAG_REFERENCES view](../sql-reference/account-usage/tag_references) with the [WAREHOUSE_METERING_HISTORY view](../sql-reference/account-usage/warehouse_metering_history) on the `object_id` and `warehouse_id` columns to get usage\ninformation by warehouse, and you can use the `tag_value` column to identify the departments that own those warehouses.\nThe following SQL statement performs this join:\n ... \nSection Title: ... > Resources not shared by departments [¶]( \"Link to this heading\")\nContent:\n```\n+-------------+-------------+-----------------+ \n | TAG_NAME    | TAG_VALUE   |   TOTAL_CREDITS | \n |-------------+-------------+-----------------| \n | NULL        | untagged    |    20.360277159 | \n | COST_CENTER | Sales       |    17.173333333 | \n | COST_CENTER | Finance     |      8.14444444 | \n +-------------+-------------+-----------------+\n```\nYou can run a similar query to perform the same attribution for all the accounts in your organization using views in the\nORGANIZATION_USAGE schema from the [organization account](organization-accounts) . The rest of the query\ndoes not change.\n ... \nSection Title: ... > Resources shared by users from different departments [¶]( \"Link to this heading\")\nContent:\nSuppose that users in different departments share the same warehouses and you want to break down the credits used by each\ndepartment. You can tag the users with a `cost_center` tag to identify the department that they belong to, and you can join\nthe [TAG_REFERENCES view](../sql-reference/account-usage/tag_references) with the [QUERY_ATTRIBUTION_HISTORY view](../sql-reference/account-usage/query_attribution_history) .\nNote\nYou can only get this data for a single account at a time. You cannot execute a query that retrieves this data across\naccounts in an organization.\nThe next sections provide examples of SQL statements for attributing costs for shared resources.\n ... \nSection Title: ... > Viewing cost by tag in Snowsight [¶]( \"Link to this heading\")\nContent:\nYou can attribute costs by reporting on the use of resources that have the `cost_center` tag. You can access this data in [Snowsight](ui-snowsight-gs.html) .\nSwitch to a role that has [access to the ACCOUNT_USAGE schema](../sql-reference/account-usage.html) .\nIn the navigation menu, select Admin » Cost management .\nSelect Consumption .\nFrom the Tags drop-down, select the `cost_center` tag.\nTo focus on a specific cost center, select a value from the list of the tag’s values.\nSelect Apply .\nFor more details about filtering in Snowsight, see [Filter by tag](cost-exploring-compute.html) ."]},{"url":"https://docs.snowflake.com/en/sql-reference/account-usage/query_attribution_history","title":"QUERY_ATTRIBUTION_HISTORY view - Snowflake Documentation","excerpts":["Section Title: QUERY_ ATTRIBUTION_ HISTORY view [¶]( \"Link to this heading\")\nContent:\nThis Account Usage view can be used to determine the compute cost of a given query run on warehouses in your account\nin the last 365 days (1 year).\nFor more information, see [Viewing cost by tag in SQL](../../user-guide/cost-attributing.html) .\n ... \nSection Title: ... > Usage notes [¶]( \"Link to this heading\")\nContent:\nFor example, the following are not included in the query cost:\nData transfer costs\nStorage costs\nCloud services costs\nCosts for serverless features\nCosts for tokens processed by AI services\nFor queries that are executed concurrently, the cost of the warehouse is attributed to individual queries based on the\nweighted average of their resource consumption during a given time interval. Short-running queries (<= ~100ms) are currently too short for per query cost attribution and are not included in the view. Data for all columns is available starting from mid-August, 2024. Some data prior to this date might be available in the view, but\nmight be incomplete.\nSection Title: ... > Query costs for related queries [¶]( \"Link to this heading\")\nContent:\nTo determine the costs of a specific query and similar queries using the query parameterized hash, replace `<query_id>` and execute the following statements:\n```\nSET query_id = '<query_id>' ; \n\n WITH query_hash_of_query AS ( \n  SELECT query_parameterized_hash \n  FROM SNOWFLAKE . ACCOUNT_USAGE . QUERY_ATTRIBUTION_HISTORY \n  WHERE query_id = $ query_id \n  LIMIT 1 \n ) \n SELECT \n  query_parameterized_hash , \n  COUNT (*) AS query_count , \n  SUM ( credits_attributed_compute ) AS recurrent_query_attributed_credits \n FROM SNOWFLAKE . ACCOUNT_USAGE . QUERY_ATTRIBUTION_HISTORY \n WHERE start_time >= DATE_TRUNC ( 'MONTH' , CURRENT_DATE ) \n  AND start_time < CURRENT_DATE \n  AND query_parameterized_hash = ( SELECT query_parameterized_hash FROM query_hash_of_query ) \n GROUP BY ALL ;\n```\nCopy\nSection Title: ... > Query costs for the current user [¶]( \"Link to this heading\")\nContent:\nTo determine the costs of queries executed by the current user for the current month, execute the following statement:\n```\nSELECT user_name , SUM ( credits_attributed_compute ) AS credits \n  FROM SNOWFLAKE . ACCOUNT_USAGE . QUERY_ATTRIBUTION_HISTORY \n  WHERE user_name = CURRENT_USER () \n    AND start_time >= DATE_TRUNC ( 'MONTH' , CURRENT_DATE ) \n    AND start_time < CURRENT_DATE \n  GROUP BY user_name ;\n```\nCopy\nFor an example of attributing warehouse costs to users, see [Resources shared by users from different departments](../../user-guide/cost-attributing.html) .\nSection Title: ... > Query costs for stored procedures [¶]( \"Link to this heading\")\nContent:\nFor stored procedures that issue multiple hierarchical queries, you can compute the attributed query costs for the\nprocedure by using the root query ID for the procedure.\nTo find the root query ID for a stored procedure, use the [ACCESS_HISTORY view](access_history) . For example,\nto find the root query ID for a stored procedure, set the `query_id` and execute the following statements:CopyFor more information, see [Example: Ancestor queries with stored procedures](../../user-guide/access-history.html) .\nTo sum the query cost for the entire procedure, replace `<root_query_id>` and execute the following statements:Copy\nSection Title: ... > Additional examples [¶]( \"Link to this heading\")\nContent:\nFor more examples, see [Resources shared by users from different departments](../../user-guide/cost-attributing.html) .\nWas this page helpful?\nYes No\n[Visit Snowflake](https://www.snowflake.com)\n[Join the conversation](https://community.snowflake.com/s/)\n[Develop with Snowflake](https://developers.snowflake.com)\n[Share your feedback](/feedback)\n[Read the latest on our blog](https://www.snowflake.com/blog/)\n[Get your own certification](https://learn.snowflake.com)\n[Privacy Notice](https://www.snowflake.com/privacy-policy/) [Site Terms](https://www.snowflake.com/legal/snowflake-site-terms/) Cookies Settings © 2026 Snowflake, Inc. All Rights Reserved.\nOn this page\n[Columns]()\n[Usage notes]()\n[Examples]()\n[Query costs for related queries]()\n[Query costs for the current user]()\n[Query costs for stored procedures]()\n[Additional examples]()\nRelated content"]},{"url":"https://docs.snowflake.com/en/release-notes/2024/other/2024-08-30-per-query-cost-attribution","title":"August 30, 2024 — Query attribution costs - Snowflake Documentation","excerpts":["Aug 30, 2024 · The new QUERY_ATTRIBUTION_HISTORY view in the ACCOUNT_USAGE schema provides information about the warehouse cost for queries and enables the attribution of ... Aug 30, 2024 · Was this page helpful? Yes No. Visit Snowflake."]},{"url":"https://www.kipi.ai/insights/optimizing-cost-attribution-in-snowflake-a-chargeback-model-guide/","title":"Optimizing Cost Attribution in Snowflake: A Chargeback Model Guide","excerpts":["Jun 20, 2025 · Cost attribution in Snowflake involves assigning usage costs to specific departments, projects, or teams. This process is vital for ... Jun 20, 2025 · Cost attribution in Snowflake involves assigning usage costs to specific departments, projects, or teams. This process is vital for ... Cost attribution in Snowflake involves assigning usage costs to specific departments, projects, or teams. This process is vital for ..."]},{"url":"https://diggrowth.com/blogs/marketing-attribution/snowflake-cost-attribution/","title":"Snowflake Cost Attribution For B2B: Assign, Track, And Optimize Usage","publish_date":"2025-12-10","excerpts":["Section Title: ... > Why Cost Attribution Matters for B2B Companies\nContent:\nAs your organization grows, so does your reliance on data. Teams launch virtual warehouses, automate pipelines, and scale workloads across departments. All of this drives innovation—but it also drives cost.\nWithout proper [attribution](https://diggrowth.com/blogs/marketing-attribution/understanding-attribution-in-sales-and-marketing-contexts/) , Snowflake spend quickly becomes a **shared expense with no clear owner** , leading to operational blind spots and inefficient decision-making. The result? You’re left reacting to higher-than-expected bills with limited insight into the underlying cause.\n ... \nSection Title: How B2B Companies Can Master Snowflake Cost Attribution > ... > Key Cost Components in Snowflake:\nContent:\nServerless Features:\nSnowflake offers serverless features such as **Snowpipe** for continuous data loading and **Materialized Views** for optimized query performance. These services are charged based on the amount of data processed, so frequent use of Snowpipe or large data transformations can add up quickly. Data Transfer Costs:\nSnowflake charges for data transfer between regions and cloud providers, as well as for loading and unloading data from external sources. If your workflows involve **frequent data movement** , this can become a significant portion of your monthly bill. Cloud Services Costs:\nThis includes the operational and management services that Snowflake provides, such as **query compilation, metadata management, security,** and **data replication** .\n ... \nSection Title: How B2B Companies Can Master Snowflake Cost Attribution > ... > Usage and Billing Views\nContent:\nSnowflake provides built-in system views through the ACCOUNT_USAGE and ORGANIZATION_USAGE schemas. These tables give you access to detailed billing and consumption data.\nKey views include:\nWAREHOUSE_METERING_HISTORY for tracking credit use by virtual warehouse\nQUERY_HISTORY for analyzing query behavior and execution context\nSTORAGE_USAGE for monitoring data volume over time\nLOGIN_HISTORY for auditing user access and activity\nWhen you combine these views with tags, user roles, and resource metadata, you gain the ability to access credit usage at a highly granular level. This enables precise cost attribution across departments, teams, and business functions.\nSection Title: How B2B Companies Can Master Snowflake Cost Attribution > ... > Usage and Billing Views\nContent:\nAbsolutely — here is a more **in-depth and comprehensive** version of the section “ **Building a Cost Attribution Strategy”** that provides both strategic context and practical guidance. This version is designed to inform B2B readers who are serious about operationalizing Snowflake cost attribution at scale.\n ... \nSection Title: How B2B Companies Can Master Snowflake Cost Attribution > ... > Automate these processes using:\nContent:\nScheduled SQL jobs that extract data from Snowflake’s ACCOUNT_USAGE views\nJoin logic to combine usage metrics with tags and user metadata\nData pipelines (e.g., dbt, Airflow) to normalize, enrich, and store attribution-ready tables\nUsage data should include compute credits consumed (WAREHOUSE_METERING_HISTORY), query-level metadata (QUERY_HISTORY), and storage trends (STORAGE_USAGE). Incorporating login and role history adds a layer of accountability for user behavior.\n ... \nSection Title: How B2B Companies Can Master Snowflake Cost Attribution > ... > Sample SQL: Warehouse Usage by Tag\nContent:\nThis query uses Snowflake’s ACCOUNT_USAGE views to attribute warehouse credit consumption based on object tags.\n**SELECT**\nwmh.WAREHOUSE_NAME,\nwmh.START_TIME::DATE AS usage_date,\nwt.TAG_VALUE AS team,\nSUM(wmh.CREDITS_USED) AS total_credits\n**FROM**\nSNOWFLAKE.ACCOUNT_USAGE.WAREHOUSE_METERING_HISTORY wmh\n**JOIN**\nSNOWFLAKE.ACCOUNT_USAGE.TAG_REFERENCES wt\nON wmh.WAREHOUSE_ID = wt.OBJECT_ID\n**WHERE**\nwt.TAG_NAME = ‘team’\nAND wmh.START_TIME >= DATEADD(‘day’, -30, CURRENT_DATE)\n**GROUP BY**\nwmh.WAREHOUSE_NAME,\nwmh.START_TIME::DATE,\nwt.TAG_VALUE\n**ORDER BY**\nusage_date DESC,\ntotal_credits DESC;\nThis query aggregates compute usage by warehouse and team, enabling a direct line of sight into how different business groups consume Snowflake resources.\n ... \nSection Title: ... > Can Snowflake’s Resource Monitors support cost attribution?\nContent:\nResource Monitors track credit usage and can alert on thresholds but do not directly attribute costs. However, combining them with tags and usage views enhances budget control and monitoring.\n[](https://diggrowth.com)\nDiGGrowth empowers CMOs, performance marketers and the entire marketing team with a team of AI agents that help them automate, optimize, and accelerate revenue."]},{"url":"https://docs.snowflake.com/en/release-notes/bcr-bundles/un-bundled/bcr-1584","title":"Organization Usage: Updated billing views | Snowflake Documentation","excerpts":["Section Title: Organization Usage: Updated billing views [¶]( \"Link to this heading\")\nContent:\nThe following views have been updated to help reconcile monthly usage statements:\n[CONTRACT_ITEMS](../../../sql-reference/organization-usage/contract_items)\n[RATE_SHEET_DAILY](../../../sql-reference/organization-usage/rate_sheet_daily)\n[REMAINING_BALANCE_DAILY](../../../sql-reference/organization-usage/remaining_balance_daily)\n[USAGE_IN_CURRENCY_DAILY](../../../sql-reference/organization-usage/usage_in_currency_daily)\nAs part of these changes, a small, one-time adjustment might be made for customers who have an active contract. Contracts begin by\ncompleting an order form.\nBilling views of the Organization Usage schema and monthly usage statements behave as follows:\nBefore the change :\nThe following makes billing reconciliation difficult:\nSection Title: Organization Usage: Updated billing views [¶]( \"Link to this heading\")\nContent:\nBilling views include usage that is not included on the monthly usage statement. For example, usage with a value of less than $0.01 is\nnot billed on a statement.\nBilling views do not use rounded values, while official values on the usage statements do.\nData types in the billing views are inconsistent.\nThe SERVICE_TYPE column of the RATE_SHEET_DAILY view does not include all types.\nIn addition, usage statements contain total usage for the contract by appending the current month to the end of the list.\nAfter the change :\nMonthly usage statements now contain usage for the current month only.\nThe billing views contain the following new columns and updated columns:"]},{"url":"https://docs.snowflake.cn/en/user-guide/cost-exploring-overall","title":"Exploring overall cost | Snowflake Documentation","excerpts":["Section Title: Exploring overall cost [¶]( \"Link to this heading\")\nContent:\nYou can explore historical cost using Snowsight, or by writing queries against views in the [ACCOUNT_USAGE](../sql-reference/account-usage) and [ORGANIZATION_USAGE](../sql-reference/organization-usage) schemas.\nSnowsight allows you to quickly and easily obtain information about cost from a visual dashboard. Queries against the usage\nviews allow you to drill down into cost data and can help generate custom reports and dashboards.\nIf you need an introduction to how costs are incurred in Snowflake, refer to [Understanding overall cost](cost-understanding-overall) .\nTo obtain a billing statement that contains information about historical usage, see [Access a billing usage statement](billing-usage-statement) ."]},{"url":"https://blog.greybeam.ai/snowflake-cost-per-query/","title":"Deep Dive: Snowflake's Query Cost and Idle Time Attribution","publish_date":"2024-10-22","excerpts":["Section Title: A Deep Dive into Snowflake's Query Cost Attribution: Finding Cost per Query\nContent:\nSnowflake's new QUERY_ATTRIBUTION_HISTORY view\nSnowflake recently released a new feature for granular cost attribution down to individual queries through the `QUERY_ATTRIBUTION_HISTORY` view in `ACCOUNT_USAGE` . As a company focused on SQL optimization, we at Greybeam were eager to dive in and see how this new capability compares to our own custom cost attribution logic. What we found was surprising - and it led us down a rabbit hole of query cost analysis.\nSection Title: ... > The Promise and Limitations of QUERY_ATTRIBUTION_HISTORY\nContent:\nThe new view aims to provide visibility into the compute costs associated with each query. Some key things to note:\nData is only available from July 1, 2024 onwards\nShort queries (<100ms) are excluded\nIdle time is not included in the attributed costs\nThere can be up to a 6 hour delay in data appearing\nThere's also a `WAREHOUSE_UTILIZATION` view that displays cost of idle time. At the time of writing, this must be enabled by your Snowflake support team.\n ... \nSection Title: ... > Step 4: Attribute Costs\nContent:\nOne important note: This approach assumes that all time within an hour is equally valuable in terms of credit consumption. In reality, Snowflake may have more complex internal algorithms for credit attribution, especially for multi-cluster warehouses or warehouses that change size within an hour. However, this weighted time-based approach provides a reasonable and transparent method for cost attribution that aligns well with Snowflake’s consumption-based billing model."]},{"url":"https://medium.com/@jordandhill/a-practical-guide-to-snowflake-notebook-cost-attribution-f1e377244275","title":"A Practical Guide to Snowflake Notebook Cost Attribution | by Jordan Hill | Medium","publish_date":"2025-10-27","excerpts":["Section Title: A Practical Guide to Snowflake Notebook Cost Attribution > Understanding Notebook Query Attribution\nContent:\nBasics you can rely on: Snowflake tracks all query activity through its `ACCOUNT_USAGE` schema, specifically the `[query_history](https://docs.snowflake.com/en/sql-reference/account-usage/query_history)` and `[query_attribution_history](https://docs.snowflake.com/en/sql-reference/account-usage/query_attribution_history)` views. When a notebook executes, it will create records in these tables as well. Additionally, Snowflake attaches metadata through **query tags** .\n ... \nSection Title: A Practical Guide to Snowflake Notebook Cost Attribution > 1. Fast Queries Are Not Cost-Attributed\nContent:\nSnowflake optimizes performance by not attributing credit costs to extremely fast queries. If a query executes in under 100 milliseconds, you may not see it reflected in the `query_attribution_history` view. This is generally acceptable because these queries consume negligible resources.\n ... \nSection Title: A Practical Guide to Snowflake Notebook Cost Attribution > Container Runtime\nContent:\nQuery the `notebooks_container_runtime_history` view to get the top-level Notebook compute cost when running on Container Runtime.\n```\nSELECT  \n    start_time,   \n    notebook_name,   \n    user_name,   \n    SUM(credits) AS total_container_runtime_credits  \nFROM snowflake.account_usage.notebooks_container_runtime_history  \nWHERE notebook_name = '<your_notebook_name>'  \nGROUP BY ALL;\n```\nFor more details, see [Snowflake’s Container Runtime cost monitoring documentation](https://docs.snowflake.com/en/user-guide/ui-snowsight/notebooks-usage) ."]},{"url":"https://medium.com/snowflake/granular-cost-attribution-and-chargeback-for-warehouse-costs-on-snowflake-cf96fb690967","title":"Granular cost attribution and chargeback for warehouse costs on Snowflake | by Kaushal Jain | Snowflake Builders Blog: Data Engineers, App Developers, AI, & Data Science | Medium","publish_date":"2024-09-03","excerpts":["Section Title: ... > Warehouse-Based Cost Allocation\nContent:\n```\nSELECT COALESCE (tag_references.tag_value,  'untagged' )  AS  tag_value,   \nSUM (warehouse_metering_history.credits_used_compute)  AS  total_credits  \nFROM  snowflake.account_usage.warehouse_metering_history  \nLEFT JOIN  snowflake.account_usage.tag_references  \nON  warehouse_metering_history.warehouse_id  =  tag_references.object_id  \nWHERE  warehouse_metering_history.start_time  >=  DATE_TRUNC( 'MONTH' , DATEADD( MONTH ,  -1 ,  CURRENT_DATE ))   \nAND  warehouse_metering_history.start_time  <  DATE_TRUNC( 'MONTH' ,   CURRENT_DATE )  \nGROUP BY COALESCE (tag_references.tag_value,  'untagged' )  \nORDER BY  total_credits  DESC ;\n```\nPress enter or click to view image in full size\n ... \nSection Title: ... > Get Kaushal Jain’s stories in your inbox\nContent:\n```\nSELECT  query_parameterized_hash,   \nCOUNT ( * )  AS  query_count,   \nSUM (credits_attributed_compute)  AS  total_credits  \nFROM  snowflake.account_usage.query_attribution_history  \nWHERE  start_time  >=  DATE_TRUNC( 'MONTH' , DATEADD( MONTH ,  -1 ,  CURRENT_DATE ))  \nAND  start_time  <  DATE_TRUNC( 'MONTH' ,  CURRENT_DATE )  \nGROUP BY  query_parameterized_hash  \nORDER BY  total_credits  DESC  \nLIMIT  20 ;\n```\nPress enter or click to view image in full size\nAdditionally, for stored procedures that often issue multiple hierarchical queries, you can compute the attributed costs for the entire procedure using the following example query, as the parent and the root query ids are available for such procedures in the view."]}],"usage":[{"name":"sku_search","count":1}]}
